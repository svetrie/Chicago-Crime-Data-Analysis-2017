---
title: "Chicago Crime Data Visualizations"
author: "Vetrie Senthilkumar"
date: "April 26, 2018"
output: html_document
---

Load Chicago Crime Data from 2017 into R and load libraries. Convert Date variable to Date type

```{r, message=FALSE}
crime_data = read.csv("Crimes_-_2001_to_present (1).csv")

library(dplyr)
library(ggplot2)
library(stringr)
```

Quantitative EDA

```{r}
dim(crime_data)
head(crime_data)
summary(crime_data)
str(crime_data)

```

Number of crime occurences for each of Chicago's 20 Districts
```{r}

ggplot(data = crime_data, aes(x = crime_data$District)) + 
  geom_bar() +
  labs(title = "Crime Occurences Per District", x = "Chicago Districts", y = "Number of Crime Occurences") + 
  scale_x_continuous(breaks = seq(min(crime_data$District), 25, by = 1)) 

```

20 most common settings that crimes occur in
```{r}
common_crime_spots = count(crime_data, Location.Description)
common_crime_spots = arrange(common_crime_spots, desc(n))
common_crime_spots = head(common_crime_spots, 20)
colnames(common_crime_spots) = c("Type of Location", "Number of Crime Occurences")

ggplot(common_crime_spots, aes(x = `Type of Location`, y = `Number of Crime Occurences`)) + 
  geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("Most Common Locations Crimes Occur In")

```

Most common types of crime
```{r}

crime_types = count(crime_data, Primary.Type)

ggplot(data = crime_data, aes(x = crime_data$Primary.Type))  +
  geom_bar() + 
  labs(title = "Crime Rates for Different Types of Crimes", x = "Types of Crimes", y = "Number of Occurrences") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

Fluctuations in overall crime rate and arrest rate during 2017
```{r}
crime_data$Date = as.character(crime_data$Date)

date_pattern = "[0-9]{1,2}/[0-9]{1,2}/[0-9]{2}"
crime_data$Date = str_extract(crime_data$Date, date_pattern)

crime_dates = count(crime_data, Date)
crime_dates$Date = as.Date.character(crime_dates$Date, format = "%m/%d/%y")

subset_arrests = subset(crime_data, Arrest == TRUE)
arrest_dates = count(subset_arrests, subset_arrests$Date)
colnames(arrest_dates) = c("Date", "n")
arrest_dates$Date = as.Date.character(arrest_dates$Date, format = "%m/%d/%y")

ggplot(crime_dates, aes(x = Date)) +
  geom_line(aes(y = crime_dates$n, color = "Crime Rate")) +
  geom_line(data = arrest_dates, aes(y = arrest_dates$n, color = "Arrest Rate")) +
  labs(title = "Crime Rate vs Arrest Rate", y = "Number of Occurences") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
  

```

Changes in crime rate by month for 5 most frequent types of crime
```{r}
most_frequent_crime_types = tail(arrange(crime_types, n), 5)
most_frequent_crime_types

assault_rate = count(subset(crime_data, crime_data$Primary.Type == "ASSAULT"), Date)
assault_rate$Date = as.Date.character(assault_rate$Date, format = "%m/%d/%y")

deceptive_pratice_rate = count(subset(crime_data, crime_data$Primary.Type == "DECEPTIVE PRACTICE"), Date)
deceptive_pratice_rate$Date = as.Date.character(deceptive_pratice_rate$Date, format = "%m/%d/%y")

criminal_damage_rate = count(subset(crime_data, crime_data$Primary.Type == "CRIMINAL DAMAGE"), Date)
criminal_damage_rate$Date = as.Date.character(criminal_damage_rate$Date, format = "%m/%d/%y")

battery_rate = count(subset(crime_data, crime_data$Primary.Type == "BATTERY"), Date)
battery_rate$Date = as.Date.character(battery_rate$Date, format = "%m/%d/%y")

theft_rate = count(subset(crime_data, crime_data$Primary.Type == "THEFT"), Date)
theft_rate$Date = as.Date.character(theft_rate$Date, format = "%m/%d/%y")

ggplot(crime_dates, aes(x = Date))  +
  geom_line(data = assault_rate, aes(y = n), colour = "red") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position = "none") +
  labs(title = "Assaults Committed over Time", x = "Date", y = "Number of Assaults")

ggplot(crime_dates, aes(x = Date, color = "blue"))  +
  geom_line(data = deceptive_pratice_rate, aes(y = n), colour = "orange") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position = "none") + 
  labs(title = "Deceptive Practice Activities over Time", x = "Date", y = "Number of Deceptive Practice Incidents")

ggplot(crime_dates, aes(x = Date))  +
  geom_line(data = criminal_damage_rate, aes(y = n), colour = "green") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position = "none") +
  labs(title = "Criminal Damage Incidents over Time", x = "Date", y = "Number of Criminal Damage Incidents")

ggplot(crime_dates, aes(x = Date))  +
  geom_line(data = battery_rate, aes(y = n), colour = "blue") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position = "none") + 
  labs(title = "Batteries Commited over Time", x = "Date", y = "Number of Batteries")

ggplot(crime_dates, aes(x = Date))  +
   geom_line(data = theft_rate, aes(y = n), color = "pink") +
  scale_x_date(date_breaks = "1 month", date_labels =  "%b %Y") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

10 Most Dangerous Community Areas
```{r}
dangerous_community_areas = count(crime_data, crime_data$Community.Area)
dangerous_community_areas = arrange(dangerous_community_areas, desc(n))
dangerous_community_areas = head(dangerous_community_areas, 10)
colnames(dangerous_community_areas) = c("Community Area", "Number of Crime Occurrences")
dangerous_community_areas$`Community Area` = as.factor(dangerous_community_areas$`Community Area`)

ggplot(dangerous_community_areas, aes(x = `Community Area`, y = `Number of Crime Occurrences`)) + 
  geom_bar(stat = "identity")

```

10 most dangerous beats (smallest geographical area of police enforcement)
```{r}
most_dangerous_beats = count(crime_data, crime_data$Beat)
colnames(most_dangerous_beats) = c("Beat", "Number of Crime Occurences")
most_dangerous_beats = arrange(most_dangerous_beats, desc(`Number of Crime Occurences`))
most_dangerous_beats = head(most_dangerous_beats, 10)
most_dangerous_beats$Beat = as.factor(most_dangerous_beats$Beat)

ggplot(most_dangerous_beats, aes(x = `Beat`, y = `Number of Crime Occurences`)) + 
  geom_bar(stat = "identity") + 
  ggtitle("Beats with Most Crime Occurences")
```


15 most dangerous streets with highest crime rates
```{r}

pattern = "[NWES].+"

crime_data$Street = str_extract(crime_data$Block, pattern)
dangerous_streets = count(crime_data, Street)
dangerous_streets = arrange(dangerous_streets, desc(n))
dangerous_streets = head(dangerous_streets, 15)
colnames(dangerous_streets) = c("Street Name", "Number of Crime Occurences")

ggplot(dangerous_streets, aes(x = `Street Name`, y = `Number of Crime Occurences`)) +
  geom_bar(stat = "identity") + 
  ggtitle("Streets with Most Crime Occurences") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```






